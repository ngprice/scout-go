syntax = "proto3";

package scout;

option go_package = "scout-go/proto;proto";

message Action {
  enum ActionType {
    	ActionScout = 0;
      ActionScoutReverse = 1;
      ActionShow = 2;
      ActionScoutAndShow = 3;
      ActionScoutAndShowReverse = 4;
      ActionReverseHand = 5;
  }
  int32 id = 1;
  ActionType actionType = 2;
  int32 paramA = 3;
  int32 paramB = 4;
  int32 paramC = 5;
  int32 paramD = 6;
}

message Game {
  string id = 1;
  int32 active_player_index = 2;
  repeated Card active_set = 3;
  int32 active_set_player_index = 4;
  int32 consecutive_scouts = 5;
  int32 round = 6;
  bool complete = 7;
}

message Player {
  string name = 1;
  int32 index = 2;
  int32 score = 3;
  repeated Card hand = 4;
  bool can_reverse_hand = 5;
  bool can_scout_and_show = 6;
}

message Card {
  int32 value1 = 1;
  int32 value2 = 2;
}


service ScoutService {
  rpc CreateGame      (CreateGameRequest)      returns (CreateGameResponse);
  rpc PlayerAction    (PlayerActionRequest)    returns (PlayerActionResponse);
  rpc GetGameState    (GetGameStateRequest)    returns (GetGameStateResponse);
  rpc GetPlayerState  (GetPlayerStateRequest)  returns (GetPlayerStateResponse);
  rpc GetValidActions (GetValidActionsRequest) returns (GetValidActionsResponse);
}

message CreateGameRequest {
  int32 num_players = 1;
}

message CreateGameResponse {
  string game_id = 1;
}

message PlayerActionRequest {
  string game_id = 1;
  int32 player_index = 2;
  Action action = 3;
}

message PlayerActionResponse {
  bool err = 1;
  string errMsg = 2;
}

message GetGameStateRequest {
  string game_id = 1;
}

message GetGameStateResponse {
  Game game = 1;
}

message GetPlayerStateRequest {
  string game_id = 1;
  int32 player_index = 2;
}

message GetPlayerStateResponse {
  Player player = 1;
}

message GetValidActionsRequest {
  string game_id = 1;
  int32 player_index = 2;
}

message GetValidActionsResponse {
  repeated bool mask = 1;
}
